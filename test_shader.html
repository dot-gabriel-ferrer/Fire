<!DOCTYPE html>
<html>
<head><title>Test</title></head>
<body>
<canvas id="test" width="400" height="400"></canvas>
<script src="shaders.js"></script>
<script>
const canvas = document.getElementById('test');
const gl = canvas.getContext('webgl');

console.log('WebGL context:', gl);

const shaderManager = new ShaderManager(gl);
shaderManager.initializeShaders();

console.log('Programs:', shaderManager.programs);

// Try to use the realistic shader
const program = shaderManager.useShader('realistic');
console.log('Program:', program);

if (program) {
    // Check for errors
    console.log('Program linked:',  gl.getProgramParameter(program, gl.LINK_STATUS));
    console.log('Program log:', gl.getProgramInfoLog(program));
    
    // Create a simple quad
    const positions = new Float32Array([-1, -1, 1, -1, -1, 1, 1, 1]);
    const buffer = gl.createBuffer();
    gl.bindBuffer(gl.ARRAY_BUFFER, buffer);
    gl.bufferData(gl.ARRAY_BUFFER, positions, gl.STATIC_DRAW);
    
    // Set uniforms
    shaderManager.setUniforms(program, {
        u_time: 0,
        u_intensity: 0.7,
        u_height: 0.6,
        u_turbulence: 0.5,
        u_temperature: 0.5,
        u_saturation: 0.8
    });
    
    // Set attributes
    const posLoc = gl.getAttribLocation(program, 'a_position');
    gl.enableVertexAttribArray(posLoc);
    gl.vertexAttribPointer(posLoc, 2, gl.FLOAT, false, 0, 0);
    
    // Draw
    gl.viewport(0, 0, 400, 400);
    gl.clearColor(0.2, 0.2, 0.2, 1);
    gl.clear(gl.COLOR_BUFFER_BIT);
    gl.drawArrays(gl.TRIANGLE_STRIP, 0, 4);
    
    console.log('Draw complete, GL error:', gl.getError());
}
</script>
</body>
</html>
